<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="epishiny">
<title>Using epishiny with linelist data • epishiny</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using epishiny with linelist data">
<meta property="og:description" content="epishiny">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">epishiny</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/epishiny.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Data Types</h6>
    <a class="dropdown-item" href="../articles/linelist_data.html">Individual Data (Linelists)</a>
    <a class="dropdown-item" href="../articles/aggregated_data.html">Aggregated Data</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/contributing.html">Contributing</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epicentre-msf/epishiny/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Using epishiny with linelist data</h1>
                        <h4 data-toc-skip class="author">Sebastian Funk,
Paul Campbell</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epicentre-msf/epishiny/blob/HEAD/vignettes/articles/linelist_data.Rmd" class="external-link"><code>vignettes/articles/linelist_data.Rmd</code></a></small>
      <div class="d-none name"><code>linelist_data.Rmd</code></div>
    </div>

    
    
<p>The <em>epishiny</em> package can work with pre-aggregated data or
with line lists, i.e. data sets in the form of tables that contain cases
as one line per individual.</p>
<p>The package provides a range of visualisations of different
aggregations of the data that can either be launched as individual
modules or as part of a shiny dashboard that can be run locally or
deployed on a server.</p>
<p>In this demonstation we will walk throught the steps of preparing
external data then visualise it by launching individual modules from
within an R script.</p>
<div class="section level2">
<h2 id="load-in-data">Load in data<a class="anchor" aria-label="anchor" href="#load-in-data"></a>
</h2>
<p>The package comes with a built in example line list
<code>df_ll</code>, but a user can also bring their own data. Here we
will use a line list of Ebola in Sierra Leone published in <span class="citation">Fang et al. (<a href="#ref-Fang2016" role="doc-biblioref">2016</a>)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://readr.tidyverse.org" class="external-link">"readr"</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org" class="external-link">"dplyr"</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://purrr.tidyverse.org/" class="external-link">"purrr"</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://r-spatial.github.io/sf/" class="external-link">"sf"</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/epicentre-msf/epishiny" class="external-link">"epishiny"</a></span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>  <span class="st">"https://raw.githubusercontent.com/parksw3/epidist-paper/main/data-raw/"</span>,</span>
<span>  <span class="st">"pnas.1518587113.sd02.csv"</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">"/"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="va">url</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">8358</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span> (6): Name, Sex, Date of symptom onset, Date of sample tested, District, ...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (2): ID, Age</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 8,358</span></span>
<span><span class="co">#&gt; Columns: 8</span></span>
<span><span class="co">#&gt; $ ID                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,…</span></span>
<span><span class="co">#&gt; $ Name                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "*****", "*****", "*****", "*****", "*****", "…</span></span>
<span><span class="co">#&gt; $ Age                     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 20, 42, 45, 15, 19, 55, 50, 8, 54, 57, 50, 27,…</span></span>
<span><span class="co">#&gt; $ Sex                     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "F", "F", "F", "F", "F", "F", "F", "F", "F", "…</span></span>
<span><span class="co">#&gt; $ `Date of symptom onset` <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "18-May-14", "20-May-14", "20-May-14", "21-May…</span></span>
<span><span class="co">#&gt; $ `Date of sample tested` <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "23-May-14", "25-May-14", "25-May-14", "26-May…</span></span>
<span><span class="co">#&gt; $ District                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Kailahun", "Kailahun", "Kailahun", "Kailahun"…</span></span>
<span><span class="co">#&gt; $ Chiefdom                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Kissi Teng", "Kissi Teng", "Kissi Tonge", "Ki…</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="set-up-geo-data">Set up geo data<a class="anchor" aria-label="anchor" href="#set-up-geo-data"></a>
</h2>
<p>We next need geological data if we want to show maps.</p>
<p><a href="https://www.geoboundaries.org/" class="external-link">geoBoundaries</a> host
sub-national administrative boundary shapefiles in various formats for
every country in the world on github.</p>
<p>The line list contains Districts (admin 2 level) and Chiefdoms (admin
3 level). We can download the corresponding data sets from geoBoundaries
via the following URLs.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shape_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  adm2 <span class="op">=</span> <span class="st">"https://github.com/wmgeolab/geoBoundaries/raw/905b0ba/releaseData/gbHumanitarian/SLE/ADM2/geoBoundaries-SLE-ADM2_simplified.geojson"</span>,</span>
<span>  adm3 <span class="op">=</span> <span class="st">"https://github.com/wmgeolab/geoBoundaries/raw/905b0ba/releaseData/gbHumanitarian/SLE/ADM3/geoBoundaries-SLE-ADM3_simplified.geojson"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">shapes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">shape_paths</span>, <span class="va">st_read</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading layer `geoBoundaries-SLE-ADM2_simplified' from data source </span></span>
<span><span class="co">#&gt;   `https://github.com/wmgeolab/geoBoundaries/raw/905b0ba/releaseData/gbHumanitarian/SLE/ADM2/geoBoundaries-SLE-ADM2_simplified.geojson' </span></span>
<span><span class="co">#&gt;   using driver `GeoJSON'</span></span>
<span><span class="co">#&gt; Simple feature collection with 14 features and 5 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -13.30893 ymin: 6.923379 xmax: -10.27056 ymax: 9.999253</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; Reading layer `geoBoundaries-SLE-ADM3_simplified' from data source </span></span>
<span><span class="co">#&gt;   `https://github.com/wmgeolab/geoBoundaries/raw/905b0ba/releaseData/gbHumanitarian/SLE/ADM3/geoBoundaries-SLE-ADM3_simplified.geojson' </span></span>
<span><span class="co">#&gt;   using driver `GeoJSON'</span></span>
<span><span class="co">#&gt; Simple feature collection with 167 features and 5 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -13.30901 ymin: 6.923379 xmax: -10.27056 ymax: 9.999253</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span></span>
<span><span class="co"># little bit of cleaning on district names to match with data</span></span>
<span><span class="va">shapes</span><span class="op">$</span><span class="va">adm2</span><span class="op">$</span><span class="va">shapeName</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"Area "</span>, <span class="st">""</span>, <span class="va">shapes</span><span class="op">$</span><span class="va">adm2</span><span class="op">$</span><span class="va">shapeName</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">shapes</span>, <span class="va">head</span><span class="op">)</span></span>
<span><span class="co">#&gt; $adm2</span></span>
<span><span class="co">#&gt; Simple feature collection with 6 features and 5 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -13.30893 ymin: 7.340922 xmax: -10.27056 ymax: 9.999253</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt;   shapeName shapeISO                 shapeID shapeGroup shapeType</span></span>
<span><span class="co">#&gt; 1  Kailahun          92492822B20773800307824        SLE      ADM2</span></span>
<span><span class="co">#&gt; 2    Kenema          92492822B72931932323564        SLE      ADM2</span></span>
<span><span class="co">#&gt; 3      Kono          92492822B77765797687755        SLE      ADM2</span></span>
<span><span class="co">#&gt; 4   Bombali          92492822B76753077936535        SLE      ADM2</span></span>
<span><span class="co">#&gt; 5    Kambia          92492822B57757993837772        SLE      ADM2</span></span>
<span><span class="co">#&gt; 6 Koinadugu          92492822B53659457212824        SLE      ADM2</span></span>
<span><span class="co">#&gt;                         geometry</span></span>
<span><span class="co">#&gt; 1 MULTIPOLYGON (((-10.80489 7...</span></span>
<span><span class="co">#&gt; 2 MULTIPOLYGON (((-10.85505 8...</span></span>
<span><span class="co">#&gt; 3 MULTIPOLYGON (((-10.64344 8...</span></span>
<span><span class="co">#&gt; 4 MULTIPOLYGON (((-12.32046 8...</span></span>
<span><span class="co">#&gt; 5 MULTIPOLYGON (((-13.2635 8....</span></span>
<span><span class="co">#&gt; 6 MULTIPOLYGON (((-10.58741 9...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $adm3</span></span>
<span><span class="co">#&gt; Simple feature collection with 6 features and 5 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -11.02525 ymin: 7.758386 xmax: -10.27056 ymax: 8.505881</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt;      shapeName shapeISO                 shapeID shapeGroup shapeType</span></span>
<span><span class="co">#&gt; 1          Dea          93885176B88884577288656        SLE      ADM3</span></span>
<span><span class="co">#&gt; 2        Jawie          93885176B40623889028536        SLE      ADM3</span></span>
<span><span class="co">#&gt; 3   Kissi Kama          93885176B21354692554384        SLE      ADM3</span></span>
<span><span class="co">#&gt; 4   Kissi Teng          93885176B65469407152324        SLE      ADM3</span></span>
<span><span class="co">#&gt; 5  Kissi Tongi          93885176B56250152587449        SLE      ADM3</span></span>
<span><span class="co">#&gt; 6 Kpeje Bongre          93885176B52534318264914        SLE      ADM3</span></span>
<span><span class="co">#&gt;                         geometry</span></span>
<span><span class="co">#&gt; 1 MULTIPOLYGON (((-10.60592 7...</span></span>
<span><span class="co">#&gt; 2 MULTIPOLYGON (((-10.91103 7...</span></span>
<span><span class="co">#&gt; 3 MULTIPOLYGON (((-10.43962 8...</span></span>
<span><span class="co">#&gt; 4 MULTIPOLYGON (((-10.43962 8...</span></span>
<span><span class="co">#&gt; 5 MULTIPOLYGON (((-10.39938 8...</span></span>
<span><span class="co">#&gt; 6 MULTIPOLYGON (((-10.8119 8....</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="launch-modules">Launch Modules<a class="anchor" aria-label="anchor" href="#launch-modules"></a>
</h2>
<p>Before we launch the modules we can define some grouping variables.
If passed to the <code>time</code> or <code>place</code> modules, a
select input will appear in the ‘options’ dropdown allowing you to group
the data by the variables you select.</p>
<p>If you want a more readable variable label to appear in the module
rather than the variable name itself, pass a named vector where the name
is the label and the value is the variable name.</p>
<p>In our example we use sex and district as a variable, but since they
are already formatted as labels there is no need to pass names:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">group_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sex"</span>, <span class="st">"District"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="place-module">Place module<a class="anchor" aria-label="anchor" href="#place-module"></a>
</h3>
<p>Now that we have the shapefiles we can collate the information
contained in the format that <em>epishiny</em> expects using the
<code><a href="../reference/geo_layer.html">geo_layer()</a></code> function. Since we are using more than one geo
layer, we combine them in a list:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">geo_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/geo_layer.html">geo_layer</a></span><span class="op">(</span></span>
<span>    layer_name <span class="op">=</span> <span class="st">"District"</span>,</span>
<span>    sf <span class="op">=</span> <span class="va">shapes</span><span class="op">$</span><span class="va">adm2</span>,</span>
<span>    name_var <span class="op">=</span> <span class="st">"shapeName"</span>,</span>
<span>    join_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shapeName"</span> <span class="op">=</span> <span class="st">"District"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/geo_layer.html">geo_layer</a></span><span class="op">(</span></span>
<span>    layer_name <span class="op">=</span> <span class="st">"Chiefdom"</span>,</span>
<span>    sf <span class="op">=</span> <span class="va">shapes</span><span class="op">$</span><span class="va">adm3</span>,</span>
<span>    name_var <span class="op">=</span> <span class="st">"shapeName"</span>,</span>
<span>    join_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shapeName"</span> <span class="op">=</span> <span class="st">"Chiefdom"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We use this to launch the place module:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/launch_module.html">launch_module</a></span><span class="op">(</span></span>
<span>  module <span class="op">=</span> <span class="st">"place"</span>,</span>
<span>  df <span class="op">=</span> <span class="va">df</span>,</span>
<span>  geo_data <span class="op">=</span> <span class="va">geo_data</span>,</span>
<span>  group_vars <span class="op">=</span> <span class="va">group_vars</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co"># only pass sex variable since district is already visualised on map</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>If you select the Chiefdom admin 3 level from the options dropdown
menu you will see a warning meassage informing you that more that 50% of
the cases could not be matched to the shapefile, so some matching of
disparate place names would be required in this case. We won’t do that
here but if you need help with this task check out our <a href="https://epicentre-msf.github.io/hmatch/" class="external-link">hmatch package</a>.</p>
</div>
<div class="section level3">
<h3 id="time-module">Time module<a class="anchor" aria-label="anchor" href="#time-module"></a>
</h3>
<p>To launch the time module, we need to pass the date variable(s) in
the line list we want to use for the x-axis.</p>
<p>Notice that the date variables are of character class in the data but
they are automatically parsed to date class in the time module via the
lubridate::as_date function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/launch_module.html">launch_module</a></span><span class="op">(</span></span>
<span>  module <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  df <span class="op">=</span> <span class="va">df</span>,</span>
<span>  date_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date of symptom onset"</span>, <span class="st">"Date of sample tested"</span><span class="op">)</span>,</span>
<span>  group_vars <span class="op">=</span> <span class="va">group_vars</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="person-module">Person module<a class="anchor" aria-label="anchor" href="#person-module"></a>
</h3>
<p>Finally, we can plot an age/sex pyramid using the person module,
passing age and sex variable names and the levels in the sex variable to
encode male and female:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/launch_module.html">launch_module</a></span><span class="op">(</span></span>
<span>  module <span class="op">=</span> <span class="st">"person"</span>,</span>
<span>  df <span class="op">=</span> <span class="va">df</span>,</span>
<span>  age_var <span class="op">=</span> <span class="st">"Age"</span>,</span>
<span>  sex_var <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>  male_level <span class="op">=</span> <span class="st">"M"</span>,</span>
<span>  female_level <span class="op">=</span> <span class="st">"F"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Fang2016" class="csl-entry">
Fang, Li-Qun, Yang Yang, Jia-Fu Jiang, Hong-Wu Yao, David Kargbo,
Xin-Lou Li, Bao-Gui Jiang, et al. 2016. <span>“Transmission Dynamics of
Ebola Virus Disease and Intervention Effectiveness in Sierra
Leone.”</span> <em>Proceedings of the National Academy of Sciences</em>
113 (16): 4488–93. <a href="https://doi.org/10.1073/pnas.1518587113" class="external-link">https://doi.org/10.1073/pnas.1518587113</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Paul Cambpell.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
