<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="epishiny">
<title>Using epishiny with aggregated data • epishiny</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using epishiny with aggregated data">
<meta property="og:description" content="epishiny">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">epishiny</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/epishiny.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Data Types</h6>
    <a class="dropdown-item" href="../articles/linelist_data.html">Individual Data (Linelists)</a>
    <a class="dropdown-item" href="../articles/aggregated_data.html">Aggregated Data</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/contributing.html">Contributing</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epicentre-msf/epishiny/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Using epishiny with aggregated data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epicentre-msf/epishiny/blob/HEAD/vignettes/articles/aggregated_data.Rmd" class="external-link"><code>vignettes/articles/aggregated_data.Rmd</code></a></small>
      <div class="d-none name"><code>aggregated_data.Rmd</code></div>
    </div>

    
    
<p>Epidemiological surveillance data is often reported in an aggregated
form by ministries of health. A typical aggregation would be by a
geographical and time unit, cases and deaths by health areaa and week
for example.</p>
<p>You can use <code>epishiny</code> to visualise data in this form by
declaring one or more <code>count_vars</code> in the data (numeric
columns containing the aggregation count totals).</p>
<p>Let’s run through an example using <a href="https://covid19.who.int/data" class="external-link">WHO’s COVID-19 daily cases and
deaths dataset</a>. The data contains daily case and death totals per
country, so we can visualise both the time and place component using
<code>epishiny</code>.</p>
<div class="section level2">
<h2 id="load-libraries">Load libraries<a class="anchor" aria-label="anchor" href="#load-libraries"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/rnaturalearth/" class="external-link">rnaturalearth</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epicentre-msf/epishiny" class="external-link">epishiny</a></span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="import-aggregated-covid-19-data-from-who">Import aggregated COVID-19 data from WHO<a class="anchor" aria-label="anchor" href="#import-aggregated-covid-19-data-from-who"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_who_covid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"https://covid19.who.int/WHO-COVID-19-global-data.csv"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">342939</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span>  (3): Country_code, Country, WHO_region</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span>  (4): New_cases, Cumulative_cases, New_deaths, Cumulative_deaths</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">date</span> (1): Date_reported</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">df_who_covid</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 342,939</span></span>
<span><span class="co">#&gt; Columns: 8</span></span>
<span><span class="co">#&gt; $ Date_reported     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2020-01-03, 2020-01-04, 2020-01-05, 2020-01-06, 202…</span></span>
<span><span class="co">#&gt; $ Country_code      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "AF", "AF", "AF", "AF", "AF", "AF", "AF", "AF", "AF"…</span></span>
<span><span class="co">#&gt; $ Country           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Afghanistan", "Afghanistan", "Afghanistan", "Afghan…</span></span>
<span><span class="co">#&gt; $ WHO_region        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "EMRO", "EMRO", "EMRO", "EMRO", "EMRO", "EMRO", "EMR…</span></span>
<span><span class="co">#&gt; $ New_cases         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span></span>
<span><span class="co">#&gt; $ Cumulative_cases  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span></span>
<span><span class="co">#&gt; $ New_deaths        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span></span>
<span><span class="co">#&gt; $ Cumulative_deaths <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="import-country-boundaries-with-rnaturalearth">Import country boundaries with rnaturalearth<a class="anchor" aria-label="anchor" href="#import-country-boundaries-with-rnaturalearth"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">world_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rnaturalearth/reference/ne_countries.html" class="external-link">ne_countries</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="st">"small"</span>, type <span class="op">=</span> <span class="st">"countries"</span>, returnclass <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">iso_a2</span>, <span class="va">name</span>, <span class="va">pop_est</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># setup the geo layer for epishiny</span></span>
<span><span class="va">geo_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geo_layer.html">geo_layer</a></span><span class="op">(</span></span>
<span>  layer_name <span class="op">=</span> <span class="st">"Country"</span>,</span>
<span>  sf <span class="op">=</span> <span class="va">world_map</span>,</span>
<span>  name_var <span class="op">=</span> <span class="st">"name"</span>,</span>
<span>  pop_var <span class="op">=</span> <span class="st">"pop_est"</span>,</span>
<span>  join_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"iso_a2"</span> <span class="op">=</span> <span class="st">"Country_code"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">geo_data</span></span>
<span><span class="co">#&gt; $layer_name</span></span>
<span><span class="co">#&gt; [1] "Country"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sf</span></span>
<span><span class="co">#&gt; Simple feature collection with 177 features and 5 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -180 ymin: -90 xmax: 180 ymax: 83.64513</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    iso_a2                     name   pop_est                       geometry</span></span>
<span><span class="co">#&gt; 1      FJ                     Fiji    889953 MULTIPOLYGON (((180 -16.067...</span></span>
<span><span class="co">#&gt; 2      TZ                 Tanzania  58005463 MULTIPOLYGON (((33.90371 -0...</span></span>
<span><span class="co">#&gt; 3      EH                W. Sahara    603253 MULTIPOLYGON (((-8.66559 27...</span></span>
<span><span class="co">#&gt; 4      CA                   Canada  37589262 MULTIPOLYGON (((-122.84 49,...</span></span>
<span><span class="co">#&gt; 5      US United States of America 328239523 MULTIPOLYGON (((-122.84 49,...</span></span>
<span><span class="co">#&gt; 6      KZ               Kazakhstan  18513930 MULTIPOLYGON (((87.35997 49...</span></span>
<span><span class="co">#&gt; 7      UZ               Uzbekistan  33580650 MULTIPOLYGON (((55.96819 41...</span></span>
<span><span class="co">#&gt; 8      PG         Papua New Guinea   8776109 MULTIPOLYGON (((141.0002 -2...</span></span>
<span><span class="co">#&gt; 9      ID                Indonesia 270625568 MULTIPOLYGON (((141.0002 -2...</span></span>
<span><span class="co">#&gt; 10     AR                Argentina  44938712 MULTIPOLYGON (((-68.63401 -...</span></span>
<span><span class="co">#&gt;           lon         lat</span></span>
<span><span class="co">#&gt; 1   177.97595 -17.9376200</span></span>
<span><span class="co">#&gt; 2    34.14207  -6.2078294</span></span>
<span><span class="co">#&gt; 3   -12.57202  24.2305626</span></span>
<span><span class="co">#&gt; 4  -110.24381  56.7019200</span></span>
<span><span class="co">#&gt; 5   -99.31483  37.2367450</span></span>
<span><span class="co">#&gt; 6    66.31159  48.0689612</span></span>
<span><span class="co">#&gt; 7    63.44288  41.3532772</span></span>
<span><span class="co">#&gt; 8   144.22612  -6.6678356</span></span>
<span><span class="co">#&gt; 9   113.26946  -0.1785159</span></span>
<span><span class="co">#&gt; 10  -64.08055 -37.2391995</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $name_var</span></span>
<span><span class="co">#&gt; [1] "name"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pop_var</span></span>
<span><span class="co">#&gt; [1] "pop_est"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $join_by</span></span>
<span><span class="co">#&gt;         iso_a2 </span></span>
<span><span class="co">#&gt; "Country_code" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "epishiny_geo_layer"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="define-count-variables-in-the-data">Define count variables in the data<a class="anchor" aria-label="anchor" href="#define-count-variables-in-the-data"></a>
</h2>
<p>We are only insterested in the new case and death variables, since
the time module will handle calculating cumulative numbers for us. Here
we supply a named vector to show different variable labels in the
module’s indicator select input.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cases"</span> <span class="op">=</span> <span class="st">"New_cases"</span>, <span class="st">"Deaths"</span> <span class="op">=</span> <span class="st">"New_deaths"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="launch-time-module">Launch time module<a class="anchor" aria-label="anchor" href="#launch-time-module"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/launch_module.html">launch_module</a></span><span class="op">(</span></span>
<span>  module <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  df <span class="op">=</span> <span class="va">df_who_covid</span>,</span>
<span>  date_vars <span class="op">=</span> <span class="st">"Date_reported"</span>,</span>
<span>  group_vars <span class="op">=</span> <span class="st">"WHO_region"</span>,</span>
<span>  count_vars <span class="op">=</span> <span class="va">count_vars</span>,</span>
<span>  show_ratio <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ratio_lab <span class="op">=</span> <span class="st">"CFR"</span>,</span>
<span>  ratio_numer <span class="op">=</span> <span class="st">"New_deaths"</span>,</span>
<span>  ratio_denom <span class="op">=</span> <span class="st">"New_cases"</span>,</span>
<span>  date_intervals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"week"</span>, <span class="st">"month"</span>, <span class="st">"year"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="launch-place-module">Launch place module<a class="anchor" aria-label="anchor" href="#launch-place-module"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># filter to data in ongoing here for more relevant attack rate estimates</span></span>
<span><span class="va">map_data_filter</span> <span class="op">&lt;-</span> <span class="va">df_who_covid</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">between</a></span><span class="op">(</span><span class="va">Date_reported</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2023-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2023-12-31"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/launch_module.html">launch_module</a></span><span class="op">(</span></span>
<span>  module <span class="op">=</span> <span class="st">"place"</span>,</span>
<span>  df <span class="op">=</span> <span class="va">map_data_filter</span>,</span>
<span>  geo_data <span class="op">=</span> <span class="va">geo_data</span>,</span>
<span>  count_vars <span class="op">=</span> <span class="va">count_vars</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="launch-person-module">Launch person module<a class="anchor" aria-label="anchor" href="#launch-person-module"></a>
</h2>
<p>Now the COVID-19 data has no age or sex variables so we can’t use the
person module, but for demonstation purposes we will show this can also
be used with an aggregated data set below.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a data set with case and death counts aggregated by age group and sex</span></span>
<span><span class="va">age_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"&lt;5"</span>, <span class="st">"5-17"</span>, <span class="st">"18-24"</span>, <span class="st">"25-34"</span>, <span class="st">"35-49"</span>, <span class="st">"50+"</span><span class="op">)</span></span>
<span><span class="va">sex_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_as</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">sex_levels</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">sex_levels</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  age_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">age_levels</span>, <span class="fl">2</span><span class="op">)</span>, levels <span class="op">=</span> <span class="va">age_levels</span><span class="op">)</span>,</span>
<span>  cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">20</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  deaths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_as</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 4</span></span></span>
<span><span class="co">#&gt;    sex    age_group cases deaths</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Male   &lt;5           22     19</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Male   5-17         63     19</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Male   18-24        65     16</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Male   25-34        37      5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Male   35-49        21     12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Male   50+         100     14</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Female &lt;5           61      7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Female 5-17         91      9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Female 18-24        86      9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Female 25-34        59     15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> Female 35-49        99     11</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> Female 50+          77     19</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># launch the module passing age, sex and count_var info</span></span>
<span><span class="fu"><a href="../reference/launch_module.html">launch_module</a></span><span class="op">(</span></span>
<span>  module <span class="op">=</span> <span class="st">"person"</span>,</span>
<span>  df <span class="op">=</span> <span class="va">df_as</span>,</span>
<span>  age_group_var <span class="op">=</span> <span class="st">"age_group"</span>,</span>
<span>  sex_var <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>  male_level <span class="op">=</span> <span class="st">"Male"</span>,</span>
<span>  female_level <span class="op">=</span> <span class="st">"Female"</span>,</span>
<span>  count_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cases"</span>, <span class="st">"deaths"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Paul Cambpell.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
